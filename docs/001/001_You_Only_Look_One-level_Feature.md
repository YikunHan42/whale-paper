# You Only Look One-level Feature

# 你只需要一层特征

### 1.背景介绍

这篇论文的背景是对特征金字塔网络（FPN）的优化。作者指出，FPN的成功在于其对物体检测优化问题的分而治之解决方案，而非多尺度特征融合。从优化的角度出发，作者改进了单级检测器来解决这个问题，而不是采用复杂的特征金字塔。

### 2.动机

论文在研究FPN原理后，分析了其**多尺度特征融合**与**分而治之**的两个优势。在研究了 FPN 的两个优势在单级检测器中的影响后，作者发现FPN最显著的优势在于它对密集物体检测优化问题的分而治之解决方案，而不是多尺度特征融合。因此，作者提出了 "只看一级特征"（YOLOF）的高效的解决方案。

### 3.模型架构、方法

作者提出的方法被称为"只看一级特征"（YOLOF）。YOLOF是一种基于单级特征的目标检测方法，通过稀释编码器和均匀匹配来提高检测性能。它的架构包括骨干网络、编码器和解码器，其中编码器生成具有多个感受野的输出特征，解码器用于分类和回归任务。



 **稀释编码器的结构示意图。图中，1×1 和 3×3 表示 1×1 和 3×3 卷积层，×4 表示四个连续的残差块。残差块中的所有卷积层之后都有一个批量规范层和一个 ReLU 层，而在投影器中，我们只使用卷积层和批量规范层。**

稀释编码器用于生成具有不同感受野的输出特征，以弥补多级特征的不足。它由投影层和剩余块组成，通过1×1卷积层和3×3卷积层来降低信道维度和细化语义上下文。接下来，通过连续叠加四个不同扩张率的扩张残差块，在3×3卷积层中生成具有多个感受野的输出特征，覆盖不同尺度的物体。

均匀匹配是为了解决YOLOF方法中正锚不平衡的问题而引入的匹配策略。通过统一匹配策略，离每个地面实况框最近的k个锚被选为正锚，确保所有地面实况框都能匹配到相同数量的正锚。这样可以平衡地对待不同尺度的地面实况框，提高检测器的性能。



 **YOLOF 简图，它由三个主要部分组成：主干网、编码器和解码器。图中，"C5/DC5 "表示骨干网的输出特征，下采样率为 32/16。Cout "表示特征的通道数。我们将编码器和解码器中的特征图的通道数设为 512。H ×W "为特征图的高度和宽度。**

YOLOF的主要组成部分包括骨干网络、编码器和解码器。

1. 骨干网络：YOLOF使用ResNet和ResNeXt系列作为骨干网络，并在ImageNet上进行了预训练。骨干网络的输出是C5特征图，具有2048个通道，下采样率为32。
2. 编码器：编码器在骨干网络之后添加了投影层和残差块。投影层包括一个1×1卷积层和一个3×3卷积层，用于降低信道维度和细化语义上下文。残差块由连续的卷积组成，包括一个1×1卷积层进行通道缩减，一个带扩张的3×3卷积层扩大感受野，以及一个1×1卷积层恢复通道数。编码器的输出特征图具有512个通道，能够覆盖各种尺度上的目标。
3. 解码器：解码器采用了RetinaNet的设计，包括分类头和回归头。分类头和回归头都由卷积层组成，但回归头有四个卷积层，而分类头只有两个。此外，回归头还为每个锚添加了隐式对象性预测，无需直接监督。最终的分类分数是通过将分类输出乘以相应的隐含对象度得到的。

### 4.实验分析

- 论文主要评估了YOLOF算法在MS COCO数据集上的性能，并与RetinaNet和DETR进行了比较。
- 在与RetinaNet的比较中，YOLOF模型在减少57%的运算次数的情况下，速度提高了2.5倍，与RetinaNet+模型的性能相当。
- YOLOF模型在大型物体上的性能优于RetinaNet+模型，但在小物体上稍逊一些。这可能是由于YOLOF模型中C5特征的跨度较大所致。
- 通过在编码器中添加扩张残差块，YOLOF模型在大型物体上的性能更好。
- 通过使用多尺度图像和更长时间的训练，作者获得了47.1 mAP的最终结果，在小物体上的竞争性能为31.8 mAP。
- 论文还比较了采用全局层的DETR和采用局部卷积层的YOLOF，结果显示YOLOF能实现与DETR相当的性能。
- YOLOF-DC5的运行速度比YOLOv4快13%，整体性能提高了0.8 mAP。
- YOLOF在整体性能上提高了0.8 mAP，并在大物体上的表现优于YOLOv4。然而，在小物体上的表现相对较弱。
- YOLOF相比于RetinaNet和DETR，训练时间和内存消耗较少，使得可以使用更大的批量进行训练，加快收敛速度。

综上所述，该论文通过实验分析了YOLOF、DETR和RetinaNet+这三种目标检测模型在训练时间、训练内存和性能方面的比较，并证明了YOLOF在速度和精度方面具有潜力，并在大物体检测上表现出色。然而，在小物体检测方面仍有改进空间。该论文的实验结果验证了YOLOF在MS COCO数据集上的有效性。

### 5.总结

这篇论文重新审视了用于单级检测器的特征金字塔网络（FPN）并提出了一种新的解决方案，即YOLOF。与传统的多尺度特征融合不同，YOLOF通过只利用单级特征进行检测，成功地解决了物体检测优化问题。该方法引入了稀释编码器和均匀匹配两个关键组件，取得了相当大的改进。

YOLOF的架构包括骨干网络、编码器和解码器。骨干网络使用ResNet和ResNeXt系列作为基础，并在ImageNet上进行了预训练。编码器通过投影层和残差块生成具有不同感受野的输出特征，以覆盖不同尺度的物体。解码器包括分类头和回归头，用于目标分类和位置回归。

通过在COCO基准上进行大量实验证明了YOLOF模型的有效性。与特征金字塔模型RetinaNet相比，YOLOF在速度上快了2.5倍，同时取得了相当的检测结果。此外，YOLOF在没有转换层的情况下，以单层特征的方式达到了DETR的性能，训练历时减少了7倍。

然而，单一尺度特征的局限性会导致对不同大小的物体或不同尺度的场景的检测性能较差。因此，尽管YOLOF在大物体检测上表现出色，但在小物体检测方面仍有改进空间。

总的来说，这篇论文提出了一种简单高效的目标检测方法，通过只利用单级特征进行检测，成功地解决了物体检测优化问题。该方法在速度和精度方面具有潜力，并为设计单级特征检测器提供了启示。然而，仍需要进一步研究来改进小物体检测的性能。



### 6.参考文献

本文：doi: 10.1109/CVPR46437.2021.01284

其他：doi: 10.48550/arXiv.2306.15988
